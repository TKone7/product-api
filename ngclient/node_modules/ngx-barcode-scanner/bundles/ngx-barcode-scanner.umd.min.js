!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("quagga"),require("@angular/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-barcode-scanner",["exports","quagga","@angular/common","@angular/core"],t):t(e["ngx-barcode-scanner"]={},e.Quagga,e.ng.common,e.ng.core)}(this,function(e,a,t,n){"use strict";function r(r,o){var a,i,s,e,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),"throw":t(1),"return":t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function n(e){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,i&&(s=2&e[0]?i["return"]:e[0]?i["throw"]||((s=i["return"])&&s.call(i),0):i.next)&&!(s=s.call(i,e[1])).done)return s;switch(i=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return c.label++,{value:e[1],done:!1};case 5:c.label++,i=e[1],e=[0];continue;case 7:e=c.ops.pop(),c.trys.pop();continue;default:if(!(s=0<(s=c.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){c=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){c.label=e[1];break}if(6===e[0]&&c.label<s[1]){c.label=s[1],s=e;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(e);break}s[2]&&c.ops.pop(),c.trys.pop();continue}e=o.call(r,c)}catch(t){e=[6,t],i=0}finally{a=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([t,e])}}}var o=["code_128","code_39","code_39_vin","ean","ean_extended","ean_8","upc","upc_e","codabar","i2of5","2of5","code_93"];function i(t){if(!o.some(function(e){return e===t}))throw new Error("This barcode type '"+t+"' is not valid.")}function s(e){return e+"_reader"}var c={inputStream:{name:"Live",type:"LiveStream",target:null,constraints:{width:{min:640},height:{min:480},aspectRatio:{min:1,max:100},facingMode:"environment"},singleChannel:!1},locator:{patchSize:"medium",halfSample:!0},locate:!0,numOfWorkers:4,decoder:{readers:["code_128_reader"]}},u=function(){function e(){this.valueChanges=new n.EventEmitter,this.started=new n.EventEmitter,this._started=!1,this.configQuagga=c}return Object.defineProperty(e.prototype,"isStarted",{get:function(){return this._started},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.stop()},e.prototype.ngOnChanges=function(e){this.restart()},e.prototype._init=function(){var o=this;return new Promise(function(t,n){a.onProcessed(function(e){return o.onProcessed(e)}),a.onDetected(function(e){return o.onDetected(e)}),o.configQuagga.inputStream.target=o.barecodeScanner.nativeElement,o.type&&(o.configQuagga.decoder.readers=function r(e){return"string"==typeof e?(i(e),[s(e)]):e.map(function(e){return i(e),s(e)})}(o.type)),o.deviceId&&(o.configQuagga.inputStream.constraints.deviceId=o.deviceId),a.init(o.configQuagga,function(e){if(e)return console.log(e),n(e);t()})})},e.prototype.start=function(){return function e(t,i,s,c){return new(s||(s=Promise))(function(e,n){function r(e){try{a(c.next(e))}catch(t){n(t)}}function o(e){try{a(c["throw"](e))}catch(t){n(t)}}function a(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(r,o)}a((c=c.apply(t,i||[])).next())})}(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this._started?[3,2]:[4,this._init()];case 1:e.sent(),a.start(),this._started=!0,this.started.next(!0),e.label=2;case 2:return[2]}})})},e.prototype.stop=function(){this._started&&(a.stop(),this._started=!1,this.started.next(!1))},e.prototype.restart=function(){this._started&&(this.stop(),this.start())},e.prototype.onProcessed=function(t){var n=a.canvas.ctx.overlay,e=a.canvas.dom.overlay;t&&(t.boxes&&(n.clearRect(0,0,parseInt(e.getAttribute("width"),10),parseInt(e.getAttribute("height"),10)),t.boxes.filter(function(e){return e!==t.box}).forEach(function(e){a.ImageDebug.drawPath(e,{x:0,y:1},n,{color:"green",lineWidth:2})})),t.box&&a.ImageDebug.drawPath(t.box,{x:0,y:1},n,{color:"#00F",lineWidth:2}),t.codeResult&&t.codeResult.code&&a.ImageDebug.drawPath(t.line,{x:"x",y:"y"},n,{color:"red",lineWidth:3}))},e.prototype.onDetected=function(e){this.valueChanges.next(e)},e.decorators=[{type:n.Component,args:[{selector:"barcode-scanner-livestream",template:'<div #BarecodeScanner class="scanner" [hidden]="!isStarted">\n</div>',encapsulation:n.ViewEncapsulation.None,styles:[".scanner{position:relative}.scanner canvas,.scanner video{max-width:100%;width:100%}.scanner canvas.drawingBuffer{position:absolute;left:0;top:0}"]}]}],e.propDecorators={type:[{type:n.Input}],deviceId:[{type:n.Input}],valueChanges:[{type:n.Output}],started:[{type:n.Output}],barecodeScanner:[{type:n.ViewChild,args:["BarecodeScanner"]}]},e}(),d=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[t.CommonModule],declarations:[u],exports:[u]}]}],e}(),l=function(){function e(){this._started=!1,this.valueChanges=new n.EventEmitter,this.started=new n.EventEmitter,this._showScanner=!1}return Object.defineProperty(e.prototype,"isStarted",{get:function(){return this._started},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showScanner",{get:function(){return this._showScanner},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.scanner.stop()},e.prototype.show=function(){this._showScanner=!0,this.scanner.start()},e.prototype.hide=function(){this._showScanner=!1,this.scanner.stop()},e.prototype.onStarted=function(e){this._started=e,this.started.next(e)},e.prototype.onValueChanges=function(e){this.valueChanges.next(e)},e.decorators=[{type:n.Component,args:[{selector:"barcode-scanner-livestream-overlay",template:'<div class="barcode-scanner-livestream-overlay" [hidden]="!showScanner">\n    <div class="barcode-scanner-livestream-overlay-content">\n        <div class="barcode-scanner-livestream-overlay-close" *ngIf="isStarted" (click)="hide()">X</div>\n        <barcode-scanner-livestream [type]="type" [deviceId]="deviceId" (valueChanges)="onValueChanges($event)" (started)="onStarted($event)"></barcode-scanner-livestream>\n    </div>\n</div>',styles:[".barcode-scanner-livestream-overlay{overflow:hidden;position:fixed;top:0;bottom:0;left:0;right:0;width:100%;background-color:rgba(0,0,0,.3);z-index:1000}.barcode-scanner-livestream-overlay .barcode-scanner-livestream-overlay-content{top:50%;position:absolute;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:90%;max-height:90%;max-width:800px}.barcode-scanner-livestream-overlay .barcode-scanner-livestream-overlay-content .barcode-scanner-livestream-overlay-close{position:absolute;right:0;padding:.5rem;width:2rem;height:2rem;line-height:2rem;text-align:center;background-color:#fff;cursor:pointer;border:3px solid #000;font-size:1.5rem;margin:-1rem;border-radius:2rem;z-index:100;box-sizing:content-box}"]}]}],e.propDecorators={type:[{type:n.Input}],deviceId:[{type:n.Input}],valueChanges:[{type:n.Output}],started:[{type:n.Output}],scanner:[{type:n.ViewChild,args:[u]}]},e}(),p=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[t.CommonModule,d],declarations:[l],exports:[l]}]}],e}();e.BarecodeScannerLivestreamModule=d,e.BarecodeScannerLivestreamComponent=u,e.BarecodeScannerLivestreamOverlayModule=p,e.BarecodeScannerLivestreamOverlayComponent=l,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-barcode-scanner.umd.min.js.map